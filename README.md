# 返礼品情報整形処理システム

## 概要
Google Drive上のExcelファイルから返礼品情報を抽出し、Google Sheetsの「情報抽出」タブに整形して出力するシステムです。

## 機能
- **Phase 1**: 基本データ抽出（商品名、商品コード等）
- **Phase 2**: 指定列データ抽出（B2セル指定またはF列起点）
- **Phase 3**: Do書き出し項目との紐付け
- **Phase 4**: Doへの書き出し
- **Phase 5**: データクリア

## 開発方針

### 基本原則
1. **Phaseごとの独立性**: 各Phaseは独立して動作する
2. **段階的な開発**: 小さな修正から段階的に実装
3. **動作確認の徹底**: 各段階での動作確認を必ず実施
4. **影響範囲の最小化**: 修正の影響範囲をPhase内に限定

### 開発フロー
1. Phase内での実装と動作確認
2. 完璧な動作確認後のUtils化検討
3. 段階的な品質向上
4. 他Phaseへの影響の段階的確認

### 品質基準
- 各Phaseは独立して完璧に動作する
- 修正はPhase内で完結する
- 問題発生時は即座にロールバック
- 段階的な実装とテストを徹底

## ファイル構成
```
gas/
├── Code.gs          # メイン制御
├── Phase1.gs        # 基本データ抽出
├── Phase2.gs        # 指定列データ抽出
├── Phase3.gs        # Do項目紐付け
├── Phase4.gs        # Doへの書き出し
├── Phase5.gs        # データクリア
├── Config.gs        # 設定管理
└── Utils.gs         # 共通機能
```

## 使用方法
1. Google Apps Scriptエディタでプロジェクトを開く
2. `main()`関数を実行
3. ファイルパスを入力（B1セル）
4. 抽出する列を指定（B2セル、空の場合はF列起点）
5. 処理完了後、情報抽出タブで結果を確認

## 設定
- スプレッドシートID: `Config.gs`で設定
- シート名: 情報抽出、Do書き出し用等
- パフォーマンス設定: チャンクサイズ、キャッシュTTL等

## 注意事項
- 大きなExcelファイルは処理時間がかかる場合があります
- 結合セルがある場合は適切に処理されます
- 一時ファイルは自動的に削除されます
