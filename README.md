# 返礼品情報整形GASプロジェクト

## 📋 概要
事業者から集めた返礼品情報を、マスタ登録用に整形するGoogle Apps Script（GAS）プロジェクト

## 🚀 主要機能
- **Phase 1**: 基本データ抽出
  - 返礼品シートから商品名を含む列を自動特定
  - A列〜D列で「商品名」を検索
  - 発見した列と右隣列のデータを抽出、セル結合処理
  
- **Phase 2**: 指定列データ抽出
  - B2セルで指定列の選択的抽出
  - F列起点の返礼品データ抽出

- **Phase 3**: Do書き出し項目との紐付け
  - 情報抽出タブのB列・C列の値をみながら、A列の項目を設定する

- **Phase 4**: データクレンジング
  - 情報抽出タブのD8以降のデータをルールに基づきクレンジングする

- **Phase 5**: Doへの書き出し
  - 単品登録と定期便登録の判別
  - 単品登録は、Do書き出し用タブへ書き込み
  - 定期便登録は、定期便処理を実行し、Do書き出し用(定期)タブへ書き込み

- **Phase 6**: データクリア
  - 処理情報をクリアする

## 📁 ファイル構成
```
do-check/
├── gas/                    # Google Apps Scriptファイル群
│   ├── Code.gs            # メイン制御（制御系のみ）
│   ├── Phase1.gs          # 基本データ抽出処理
│   ├── Phase2.gs          # 指定列データ抽出処理
│   ├── Config.gs          # 設定定数
│   └── Utils.gs           # ユーティリティ関数（パス処理、共通処理）
├── README.md               # このファイル（プロジェクト概要）
├── SPECIFICATION.md        # 詳細仕様書
└── IMPLEMENTATION.md       # 実装詳細
```

## 🎯 対象データ
- 返礼品シート（Excelファイル .xlsx）
- 自治体フォルダ内の事業者フォルダ
- 指定されたセル範囲のデータ

## 🔧 技術仕様
- **言語**: Google Apps Script (GAS)
- **対象**: Excelファイル (.xlsx)
- **出力**: スプレッドシート形式
- **対応**: セル結合、動的列位置

## 📊 スプレッドシート構成
- **ベーススプレッドシート**: [返礼品情報整形用スプレッドシート](https://docs.google.com/spreadsheets/d/1W-Kmre4FTL5iU0VNSs5Z4vLVsXzFebLYlxSxnPWkxPQ/edit?gid=0#gid=0)

### タブ構成
1. **情報抽出** - 返礼品シートからのデータ抽出設定
2. **Do書き出し用** - 通常便用のデータ出力
3. **Do書き出し用(定期)** - 定期便用のデータ出力
4. **自治体フォルダ** - 自治体フォルダの管理

## 🚀 使用方法

### 1. 基本設定
1. **情報抽出タブのB1セル**に返礼品シートのファイルパスを設定
2. **自治体フォルダタブ**に自治体フォルダ情報を設定

### 2. 実行手順
1. GASプロジェクトで `main()` 関数を実行
2. 自動的にPhase 1とPhase 2の処理が実行される

### 3. 個別テスト
- **Phase 1**: `testPhase1()` 関数でテスト実行
- **Phase 2**: `testPhase2()` 関数でテスト実行
- **Utils**: `testUtils()` 関数でテスト実行

### 4. 出力結果
- **B8:C** - Phase 1の基本データ（商品名列と右隣列）
- **D4以降** - Phase 2の指定列データ（1列1返礼品形式）

## 📈 開発状況
- [x] **Phase 1**: 基本データ抽出（完了）
- [x] **Phase 2**: 指定列データ抽出（完了）
- [ ] **Phase 3**: Do書き出し用タブへの出力（予定）

## 🔍 詳細情報
- **仕様詳細**: [SPECIFICATION.md](./SPECIFICATION.md)
- **実装詳細**: [IMPLEMENTATION.md](./IMPLEMENTATION.md)

## 📝 注意事項
- Google Apps Scriptの実行時間制限（6分）に注意
- 大量データ処理時は分割実行を検討
- 実行前にテスト実行で動作確認を推奨
